!function(){const t=window.WORKS||[],e=(t,e=document)=>e.querySelector(t);function l(t){return t?t.replace(/\.(png|jpe?g)$/i,".webp"):""}!function(){const s=new URLSearchParams(window.location.search).get("slug"),n=t.find(t=>t.slug===s)||t[0];if(!n)return;e("[data-detail-title]").textContent=`${n.title_zh} / ${n.title_en}`;const i=`${n.role_zh||""}${n.role_zh&&n.role_en?" / ":""}${n.role_en||""}`;e("[data-detail-role]").textContent=i||"",e("[data-detail-year]").textContent=n.year;const a=`${n.one_line_zh||""}${n.one_line_en?" "+n.one_line_en:""}`;e("[data-detail-desc]").textContent=a||"";const o=e("[data-detail-credits]");if(o){const t=n.credits&&n.credits.length?n.credits:["待补充 / To be updated"];o.innerHTML=t.map(t=>`<li>${t}</li>`).join("")}const c=e("[data-detail-tools]");if(c){const t=n.tools&&n.tools.length?n.tools:["DaVinci Resolve"];c.innerHTML=t.map(t=>`<span class="chip">${t}</span>`).join("")}const d=e("[data-detail-process]");if(d){const t=n.process&&n.process.length?n.process:["前期策划 / Pre‑production","现场执行 / On‑set","后期剪辑 / Post"];d.innerHTML=t.map(t=>`\n          <div class="skill-card">\n            <strong>${t.split("/")[0].trim()}</strong>\n            <p style="margin-top: 6px; color: #6b7280;">${t}</p>\n          </div>\n        `).join("")}const r=e("[data-detail-stills]");if(r){r.classList.toggle("stills-large","bookstore"===n.slug);const t=n.stills&&n.stills.length?n.stills:[];t.length&&(r.innerHTML=t.map((t,e)=>{const s=l(t);return`<div class="still-card"><picture>${s&&s!==t?`<source srcset="${s}" type="image/webp" />`:""}<img alt="still ${e+1}" src="${t}" loading="lazy" decoding="async" /></picture></div>`}).join(""))}const p=e("[data-detail-iframe]"),y=e("[data-detail-media]"),u=e("[data-detail-media-webp]"),$=y?y.closest("picture"):null,_=e("[data-detail-cover]"),b=e("[data-detail-cover-webp]"),g=_?_.closest("picture"):null;if(n.embed)p.src=n.embed,p.style.display="block",y&&(y.style.display="none"),$&&($.style.display="none");else if(p.style.display="none",y){const t=n.media||n.cover||n.stills&&n.stills[0]||"",e=n.media_webp||l(t);t?(y.src=t,y.alt=`${n.title_zh} / ${n.title_en}`,y.style.display="block",u&&e&&e!==t&&u.setAttribute("srcset",e),$&&($.style.display="block")):(y.style.display="none",$&&($.style.display="none"))}if(_){const t=n.cover||n.stills&&n.stills[0]||"",e=n.cover_webp||l(t);t?(_.src=t,_.alt=`${n.title_zh} / ${n.title_en}`,_.style.display="block",b&&e&&e!==t&&b.setAttribute("srcset",e),g&&(g.style.display="block")):(_.style.display="none",g&&(g.style.display="none"))}const m=e("[data-detail-link]");m.href=n.link||"#",m.textContent=n.link?"打开原链接 / Open Link":"链接待补充（未上线流媒体）"}()}();